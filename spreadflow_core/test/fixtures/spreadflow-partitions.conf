from __future__ import absolute_import
from __future__ import division
from __future__ import unicode_literals

from spreadflow_core.proc import SyntheticSource, DebugLog
from spreadflow_core.script import Process, duplicate

items = [
    (0, 'hello world')
]

@Process(partition='consumer')
def consumer(ctx):
    yield DebugLog()

@Process(partition='producer')
def producer(ctx):
    yield SyntheticSource(items)
    for port in duplicate(ctx, 'consumer'): yield port
